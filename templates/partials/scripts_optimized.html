{% load static %}
<!-- ìµœì í™”ëœ JavaScript ë¡œë“œ -->

<!-- 1. Django í…œí”Œë¦¿ ë°ì´í„° ì „ë‹¬ (ê°€ì¥ ë¨¼ì €) -->
<script>
    // Djangoì—ì„œ ì „ë‹¬ëœ ë°ì´í„°ë¥¼ ì „ì—­ ë³€ìˆ˜ë¡œ ì„¤ì •
    window.djangoData = {
        csrf_token: '{{ csrf_token }}',
        
        // URL íŒ¨í„´
        urls: {
            popular_searches: '/api/search/',
            statistics: '/api/schema/',
            bulk_translate: ''
        },
        
        // í˜„ì¬ ê²€ìƒ‰ ì •ë³´
        search: {
            query: "{{ message|escapejs }}",
            translated: "{{ translated_message|escapejs }}",
            phrase: "{{ search_used|escapejs }}",
            hasResults: {{ movies|yesno:"true,false" }},
            totalResults: {{ total_results|default:0 }},
            fromCache: {{ from_cache|yesno:"true,false" }},
            source: "{{ source|default:'database' }}"
        },
        
        // ì„¤ì •
        settings: {
            maxSearchLength: 500,
            minSearchLength: 2,
            debounceDelay: 300,
            cacheTimeout: 600000
        }
    };
</script>

<!-- 2. ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ (deferë¡œ ìµœì í™”) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" defer></script>

<!-- 3. ëª¨ë“ˆí™”ëœ JavaScript (deferë¡œ ìµœì í™”, ìˆœì„œ ì¤‘ìš”!) -->
<script src="{% static 'js/app.js' %}" defer></script>        <!-- ì•± ì´ˆê¸°í™” & ì „ì—­ ì„¤ì • -->
<script src="{% static 'js/utils.js' %}" defer></script>      <!-- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤ -->
<script src="{% static 'js/search.js' %}" defer></script>     <!-- ê²€ìƒ‰ í¼ & ì…ë ¥ ì²˜ë¦¬ -->
<script src="{% static 'js/loading.js' %}" defer></script>    <!-- ë¡œë”© ì• ë‹ˆë©”ì´ì…˜ ì‹œìŠ¤í…œ -->
<script src="{% static 'js/ui.js' %}" defer></script>         <!-- UI ì¸í„°ë™ì…˜ & ì´ë²¤íŠ¸ -->

<!-- 4. ê°œë°œ í™˜ê²½ì—ì„œë§Œ ë¡œë“œë˜ëŠ” ë””ë²„ê·¸ ìŠ¤í¬ë¦½íŠ¸ (ì„ íƒì‚¬í•­) -->
{% if settings.DEBUG %}
<script>
    console.log('ğŸ¬ ë””ë²„ê·¸ ëª¨ë“œ í™œì„±í™”');
    console.log('ğŸ“Š Django ë°ì´í„°:', window.djangoData);
    
    // ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§
    window.addEventListener('load', function() {
        console.log('âš¡ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ:', performance.now().toFixed(2) + 'ms');
    });
</script>
{% endif %}